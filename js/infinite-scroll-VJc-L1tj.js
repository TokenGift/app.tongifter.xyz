import{I as t,P as e,r as n,m as r,e as i,R as o,_ as a,Q as c,l as u}from"./index-BM7yVPGY.js";import{_ as l,a as f,b as s,c as d,u as v,d as m}from"./index-W5PCvv2Z.js";import{D as h}from"./dot-loading-BewZ1O25.js";var p=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},y="object"==typeof t&&t&&t.Object===Object&&t,g="object"==typeof self&&self&&self.Object===Object&&self,b=y||g||Function("return this")(),j=b,E=function(){return j.Date.now()},w=/\s/;var S=function(t){for(var e=t.length;e--&&w.test(t.charAt(e)););return e},x=/^\s+/;var T=function(t){return t?t.slice(0,S(t)+1).replace(x,""):t},M=b.Symbol,O=M,N=Object.prototype,I=N.hasOwnProperty,R=N.toString,C=O?O.toStringTag:void 0;var $=function(t){var e=I.call(t,C),n=t[C];try{t[C]=void 0;var r=!0}catch(o){}var i=R.call(t);return r&&(e?t[C]=n:delete t[C]),i},L=Object.prototype.toString;var P=$,W=function(t){return L.call(t)},k=M?M.toStringTag:void 0;var B=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":k&&k in Object(t)?P(t):W(t)},D=function(t){return null!=t&&"object"==typeof t};var F=T,_=p,A=function(t){return"symbol"==typeof t||D(t)&&"[object Symbol]"==B(t)},H=/^[-+]0x[0-9a-f]+$/i,Q=/^0b[01]+$/i,U=/^0o[0-7]+$/i,q=parseInt;var z=p,G=E,J=function(t){if("number"==typeof t)return t;if(A(t))return NaN;if(_(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=_(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=F(t);var n=Q.test(t);return n||U.test(t)?q(t.slice(2),n?2:8):H.test(t)?NaN:+t},K=Math.max,V=Math.min;var X=function(t,e,n){var r,i,o,a,c,u,l=0,f=!1,s=!1,d=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function v(e){var n=r,o=i;return r=i=void 0,l=e,a=t.apply(o,n)}function m(t){var n=t-u;return void 0===u||n>=e||n<0||s&&t-l>=o}function h(){var t=G();if(m(t))return p(t);c=setTimeout(h,function(t){var n=e-(t-u);return s?V(n,o-(t-l)):n}(t))}function p(t){return c=void 0,d&&r?v(t):(r=i=void 0,a)}function y(){var t=G(),n=m(t);if(r=arguments,i=this,u=t,n){if(void 0===c)return function(t){return l=t,c=setTimeout(h,e),f?v(t):a}(u);if(s)return clearTimeout(c),c=setTimeout(h,e),v(u)}return void 0===c&&(c=setTimeout(h,e)),a}return e=J(e)||0,z(n)&&(f=!!n.leading,o=(s="maxWait"in n)?K(J(n.maxWait)||0,e):o,d="trailing"in n?!!n.trailing:d),y.cancel=function(){void 0!==c&&clearTimeout(c),l=0,r=u=i=c=void 0},y.flush=function(){return void 0===c?a:p(G())},y},Y=p;const Z=e((function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return Y(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),X(t,e,{leading:r,maxWait:e,trailing:i})}));const tt="adm-infinite-scroll",et={threshold:250,children:(t,e,n)=>o.createElement(rt,{hasMore:t,failed:e,retry:n})},nt=t=>{const e=r(et,t),[u,h]=n.useState(!1),p=function(t){var e=this,r=n.useRef(!1);return n.useCallback((function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return l(e,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:if(r.current)return[2];r.current=!0,e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,t.apply(void 0,s([],d(n),!1))];case 2:return[2,e.sent()];case 3:throw e.sent();case 4:return r.current=!1,[7];case 5:return[2]}}))}))}),[t])}((t=>a(void 0,void 0,void 0,(function*(){try{yield e.loadMore(t)}catch(n){throw h(!0),n}})))),y=n.useRef(null),[g,b]=n.useState({}),j=n.useRef(g),[E,w]=n.useState(),{run:S}=(x={wait:100,leading:!0,trailing:!0},M=v((()=>a(void 0,void 0,void 0,(function*(){if(j.current!==g)return;if(!e.hasMore)return;const t=y.current;if(!t)return;if(!t.offsetParent)return;const n=c(t);if(w(n),!n)return;const r=t.getBoundingClientRect().top,i=function(t){return t===window}(n)?window.innerHeight:n.getBoundingClientRect().bottom;if(i>=r-e.threshold){const t={};j.current=t;try{yield p(!1),b(t)}catch(o){}}})))),O=null!==(T=null==x?void 0:x.wait)&&void 0!==T?T:1e3,N=n.useMemo((function(){return Z((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M.current.apply(M,s([],d(t),!1))}),O,x)}),[]),m((function(){N.cancel()})),{run:N,cancel:N.cancel,flush:N.flush});var x,T,M,O,N;return n.useEffect((()=>{S()})),n.useEffect((()=>{if(y.current&&E)return E.addEventListener("scroll",t),()=>{E.removeEventListener("scroll",t)};function t(){S()}}),[E]),i(e,o.createElement("div",{className:tt,ref:y},"function"==typeof e.children?e.children(e.hasMore,u,(function(){return a(this,void 0,void 0,(function*(){h(!1);try{yield p(!0),b(j.current)}catch(t){}}))})):e.children))},rt=t=>{const{locale:e}=u();return t.hasMore?t.failed?o.createElement("span",null,o.createElement("span",{className:`${tt}-failed-text`},e.InfiniteScroll.failedToLoad),o.createElement("a",{onClick:()=>{t.retry()}},e.InfiniteScroll.retry)):o.createElement(o.Fragment,null,o.createElement("span",null,e.common.loading),o.createElement(h,null)):o.createElement("span",null,e.InfiniteScroll.noMore)};export{nt as I};
