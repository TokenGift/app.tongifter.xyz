import{r as s,j as e,s as a,c as i,u as t,a as r,$ as n}from"./index-BM4t0dom.js";import{G as o}from"./index-diO4Y3MI.js";import{I as c}from"./image-BqRqvYkq.js";import{S as l}from"./index-BbxPUHWE.js";import{F as m}from"./index-UygN4H9t.js";import{$ as d}from"./useCustomNavigate-DaIRNIgw.js";import"./attach-properties-to-component-CClyKAqJ.js";import"./index-B881MXQ7.js";import"./index-BoKjaRnR.js";import"./use-props-value-3xKJa1iI.js";import"./logo-2z5xhOvM.js";const p="_head_info_13584_1",u="_content_info_13584_4",j="_title_13584_8",x="_gift_recom_13584_13",_="_item_13584_21",h="_item_title_13584_33",v="_customSkeleton_13584_39",f="_gift_disco_13584_43",g=i=>{const t=s.useRef(),[r,n]=s.useState(),[o,c]=s.useState(!0),l=()=>{const s=+new Date,e=parseInt(""+(i.expire-s)/1e3),a=parseInt(""+e/60/60),r=parseInt(""+e/60%60),o=parseInt(""+e%60);n({h:a<10?`0${a}h`:`${a}h`,m:r<10?`0${r}m`:`${r}m`,s:o<10?`0${o}s`:`${o}s`}),e<=0?(clearTimeout(t.current),n({h:"00h",m:"00m",s:"00s"}),c(!1)):t.current=setTimeout((()=>{l()}),1e3)};return s.useEffect((()=>(i.expire?l():(n({h:"00h",m:"00m",s:"00s"}),c(!1)),()=>{clearTimeout(t.current)})),[]),e.jsx(e.Fragment,{children:o?e.jsx("div",{className:"count-down",onClick:s=>{s.stopPropagation(),a("Waiting for activation.",3)},children:e.jsxs("p",{className:"count-down-time",children:[null==r?void 0:r.h,":",null==r?void 0:r.m,":",null==r?void 0:r.s]})}):e.jsx(e.Fragment,{})})},{discoveryGiftList:N}=n("common"),y=i((s=>s.common))((a=>{const{tgUserInfoRaw:i}=a,n=d(),{t:y}=t(),[I,w]=s.useState(null),[$,C]=s.useState(null),S=async s=>{n("/receive?id="+s)},T=()=>{(async()=>{const[s]=await N(i);200===(null==s?void 0:s.code)&&(w(null==s?void 0:s.data.discovery),C(null==s?void 0:s.data.recommend))})()};return r.useActivate((()=>{T()})),s.useEffect((()=>{T()}),[]),e.jsxs("div",{className:"warp",children:[e.jsxs("div",{className:"content",children:[e.jsx("div",{className:p,onClick:()=>(async()=>{n("/tip?id=1")})(),children:e.jsx(c,{src:"/img/img_bg_03.J83xY7_H.jpg",placeholder:e.jsx(l.Paragraph,{style:{width:"100%"}}),style:{borderRadius:10}})}),e.jsxs("div",{className:u,children:[e.jsx("span",{className:j,children:y("add_recommended_gifts")}),e.jsx("div",{className:x,children:null==$?e.jsx(l.Paragraph,{lineCount:5,animated:!0}):null==$?void 0:$.map(((s,a)=>e.jsxs("div",{className:_,onClick:()=>{S(s.id)},children:[e.jsx(g,{expire:s.startTimeTs}),e.jsx(c,{fit:"cover",placeholder:e.jsx(l,{className:v,animated:!0}),src:s.coverImgPre})]},a)))}),e.jsx("span",{className:j,children:y("add_discovery_gifts")}),e.jsx("div",{className:f,children:null==I?e.jsx(l.Paragraph,{lineCount:5,animated:!0}):e.jsx(o,{columns:3,gap:8,children:null==I?void 0:I.map(((s,a)=>e.jsx(o.Item,{span:1,children:e.jsxs("div",{className:_,onClick:()=>{S(s.id)},children:[e.jsx(c,{fit:"cover",placeholder:e.jsx(l,{className:v,animated:!0}),src:s.coverImgPre}),e.jsxs("div",{className:h,children:[s.totalAmount," ",s.tokenSymbol]}),e.jsx(g,{expire:s.startTimeTs})]})},a)))})})]})]}),e.jsx("div",{className:"footer",children:e.jsx(m,{})})]})}));export{y as default};
