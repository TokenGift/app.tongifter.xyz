import{r as s,j as e,c as a,u as i,a as t,$ as r}from"./index-CiINnPf6.js";import{G as n}from"./index-Dcu-AL3p.js";import{I as o}from"./image-YbmKuVaq.js";import{S as c}from"./index-Ciq_DaGO.js";import{F as l}from"./index-BHmwlXs4.js";import{$ as m}from"./useCustomNavigate-CBJDzRc2.js";import"./attach-properties-to-component-CClyKAqJ.js";import"./index-CRQw-w_b.js";import"./use-props-value-C7qbBqwc.js";import"./logo-2z5xhOvM.js";const d="_head_info_13584_1",p="_content_info_13584_4",u="_title_13584_8",j="_gift_recom_13584_13",x="_item_13584_21",_="_item_title_13584_33",h="_customSkeleton_13584_39",v="_gift_disco_13584_43",f=a=>{const i=s.useRef(),[t,r]=s.useState(),[n,o]=s.useState(!0),c=()=>{const s=+new Date,e=parseInt(""+(a.expire-s)/1e3),t=parseInt(""+e/60/60),n=parseInt(""+e/60%60),l=parseInt(""+e%60);r({h:t<10?`0${t}h`:`${t}h`,m:n<10?`0${n}m`:`${n}m`,s:l<10?`0${l}s`:`${l}s`}),e<=0?(clearTimeout(i.current),r({h:"00h",m:"00m",s:"00s"}),o(!1)):i.current=setTimeout((()=>{c()}),1e3)};return s.useEffect((()=>(a.expire?c():(r({h:"00h",m:"00m",s:"00s"}),o(!1)),()=>{clearTimeout(i.current)})),[]),e.jsx(e.Fragment,{children:n?e.jsx("div",{className:"count-down",onClick:s=>{s.stopPropagation()},children:e.jsxs("p",{className:"count-down-time",children:[null==t?void 0:t.h,":",null==t?void 0:t.m,":",null==t?void 0:t.s]})}):e.jsx(e.Fragment,{})})},{discoveryGiftList:g}=r("common"),N=a((s=>s.common))((a=>{const{tgUserInfoRaw:r}=a,N=m(),{t:y}=i(),[I,w]=s.useState(null),[$,C]=s.useState(null),S=async s=>{N("/receive?id="+s)},T=()=>{(async()=>{const[s]=await g(r);200===(null==s?void 0:s.code)&&(w(null==s?void 0:s.data.discovery),C(null==s?void 0:s.data.recommend))})()};return t.useActivate((()=>{T()})),s.useEffect((()=>{T()}),[]),e.jsxs("div",{className:"warp",children:[e.jsxs("div",{className:"content",children:[e.jsx("div",{className:d,onClick:()=>(async()=>{N("/tip?id=1")})(),children:e.jsx(o,{src:"/img/img_bg_03.J83xY7_H.jpg",placeholder:e.jsx(c.Paragraph,{style:{width:"100%"}}),style:{borderRadius:10}})}),e.jsxs("div",{className:p,children:[e.jsx("span",{className:u,children:y("add_recommended_gifts")}),e.jsx("div",{className:j,children:null==$?e.jsx(c.Paragraph,{lineCount:5,animated:!0}):null==$?void 0:$.map(((s,a)=>e.jsxs("div",{className:x,onClick:()=>{S(s.id)},children:[e.jsx(f,{expire:s.startTimeTs}),e.jsx(o,{fit:"cover",placeholder:e.jsx(c,{className:h,animated:!0}),src:s.coverImgPre})]},a)))}),e.jsx("span",{className:u,children:y("add_discovery_gifts")}),e.jsx("div",{className:v,children:null==I?e.jsx(c.Paragraph,{lineCount:5,animated:!0}):e.jsx(n,{columns:3,gap:8,children:null==I?void 0:I.map(((s,a)=>e.jsx(n.Item,{span:1,children:e.jsxs("div",{className:x,onClick:()=>{S(s.id)},children:[e.jsx(o,{fit:"cover",placeholder:e.jsx(c,{className:h,animated:!0}),src:s.coverImgPre}),e.jsxs("div",{className:_,children:[s.totalAmount," ",s.tokenSymbol]}),e.jsx(f,{expire:s.startTimeTs})]})},a)))})})]})]}),e.jsx("div",{className:"footer",children:e.jsx(l,{})})]})}));export{N as default};
